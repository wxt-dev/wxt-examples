<!-- Generated by scripts/generate-diffs.ts -->

# Vue I18n

> Based off the [`vue`](https://github.com/wxt-dev/wxt/tree/main/templates/vue) template.
>
> ```sh
> npx wxt@latest init --template vue
> ```

This example shows you have to use the builtin `browser.i18n` API along side [`vue-i18n`](https://vue-i18n.intlify.dev) (optimized with [`@intlify/unplugin-vue-i18n`](https://github.com/intlify/bundle-tools/tree/main/packages/unplugin-vue-i18n)) for localizing or translating an extension.

> You can localize your app without `vue-i18n`, just using the `browser.i18n` APIs, but `vue-i18n` will make it much easier to use.

## Setup

First, let's install all the packages:

###### package.json

```diff
@@ -12,15 +12,17 @@
     "zip": "wxt zip",
     "zip:firefox": "wxt zip -b firefox",
     "compile": "vue-tsc --noEmit",
     "postinstall": "wxt prepare"
   },
   "dependencies": {
-    "vue": "^3.4.0"
+    "vue": "^3.4.0",
+    "vue-i18n": "9"
   },
   "devDependencies": {
+    "@intlify/unplugin-vue-i18n": "^1.4.0",
     "@vitejs/plugin-vue": "^5.0.1",
     "typescript": "^5.3.3",
     "vue-tsc": "^1.8.27",
     "wxt": "^0.16.0"
   }
 }
```

```sh
pnpm i
```

We need to update our `wxt.config.ts` file, several changes here:

1. Add `@intlify/unplugin-vue-i18n` to Vite
1. Add a `name`, `description`, and `default_locale` to the manifest

###### wxt.config.ts

```diff
@@ -1,14 +1,26 @@
 import { defineConfig } from 'wxt';
 import vue from '@vitejs/plugin-vue';
+import vueI18n from '@intlify/unplugin-vue-i18n/vite';

 // See https://wxt.dev/api/config.html
 export default defineConfig({
   imports: {
     addons: {
       vueTemplate: true,
     },
   },
   vite: () => ({
-    plugins: [vue()],
+    plugins: [
+      vue(),
+      // See https://vue-i18n.intlify.dev/guide/advanced/optimization.html
+      vueI18n({
+        include: 'assets/locales/*.json',
+      }),
+    ],
   }),
+  manifest: {
+    name: '__MSG_extName__',
+    description: '__MSG_extDescription__',
+    default_locale: 'en',
+  },
 });
```

Finally, we need to create an instance of `vue-i18n` so we can use it in our code.

###### utils/i18n.ts

```ts
import { createI18n } from 'vue-i18n';
// Use your default locale when importing the schema
import type schema from '~/assets/locales/en.json';
import messages from '@intlify/unplugin-vue-i18n/messages';

export type I18nSchema = typeof schema;
export type I18nLocales = 'en' | 'ko';

export default createI18n<[I18nSchema], I18nLocales>({
  messages: messages as any,
});
```

## Adding Translations

When using `vue-i18n`, it's recommended to store the runtime translations separate from the manifest translations.

> This is because `vue-i18n` handles placeholders differently than `browser.i18n`. So rather than try and combine the two, it's much simpler to store them in different locations.

First, the manifest translations go in the `public/_locales` directory.

###### public/\_locales/en/messages.json

```json
{
  "extName": {
    "message": "I18n Example"
  },
  "extDescription": {
    "message": "Example of how to localize a WXT web extension."
  }
}
```

###### public/\_locales/ko/messages.json

```json
{
  "extName": {
    "message": "I18n 예제"
  },
  "extDescription": {
    "message": "WXT 웹 확장 프로그램을 지역화하는 방법의 예."
  }
}
```

> Note that we specified the "en" locale as the deafult. We also used `extName` and `extDescription` in the manifest, which are declared in these files.
>
> See [Chrome's internationalization docs](https://developer.chrome.com/docs/extensions/reference/i18n/) for more details around this setup.

Second, we'll put the `vue-i18n` translations in the `assets/` directory. This is where the majority of translations will go.

###### assets/locales/en.json

```json
{
  "some-key": "This text is localized."
}
```

###### assets/locales/ko.json

```json
{
  "some-key": "이 텍스트는 로컬라이즈되었습니다."
}
```

## Using Translations

You can use either `browser.i18n` or `i18n` (auto-imported from `utils/i18n.ts`) to get translations in the background or content scripts:

###### entrypoints/background.ts

```diff
@@ -1,3 +1,6 @@
 export default defineBackground(() => {
   console.log('Hello background!', { id: browser.runtime.id });
+
+  console.log(browser.i18n.getMessage('extName'));
+  console.log(i18n.global.t('some-key'));
 });
```

Inside Vue, we'll want to setup a composable. This composable will include type-safety to make sure the message key exists, and will be auto-imported into our components.

###### composables/useI18n.ts

```ts
import { I18nLocales, I18nSchema } from '@/utils/i18n';
import { useI18n } from 'vue-i18n';

export default function () {
  return useI18n<[I18nSchema], I18nLocales>();
}
```

Finally, you can use the new composable in your components. Don't forget to add the plugin to your Vue app!

###### entrypoints/popup/main.ts

```diff
@@ -1,5 +1,5 @@
 import { createApp } from 'vue';
 import './style.css';
 import App from './App.vue';

-createApp(App).mount('#app');
+createApp(App).use(i18n).mount('#app');
```

###### components/HelloWorld.vue

```diff
@@ -2,17 +2,20 @@
 import { ref } from 'vue';

 defineProps({
   msg: String,
 });

+const { t } = useI18n();
+
 const count = ref(0);
 </script>

 <template>
   <h1>{{ msg }}</h1>
+  <h2>{{ t('some-key') }}</h2>

   <div class="card">
     <button type="button" @click="count++">count is {{ count }}</button>
     <p>
       Edit
       <code>components/HelloWorld.vue</code> to test HMR
```
